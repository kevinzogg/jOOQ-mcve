package org.jooq.mcve.repository;

import org.jooq.DSLContext;
import org.jooq.mcve.model.Product;
import org.springframework.stereotype.Component;

import java.util.List;

import static org.jooq.mcve.gen.Tables.BIL_PRODUCT;

@Component
public class ProductRepository {

    private final DSLContext ctx;

    public ProductRepository(DSLContext ctx) {
        this.ctx = ctx;
    }

    public List<Product> findActiveProducts() {
        return ctx.selectFrom(BIL_PRODUCT)
                .fetchInto(Product.class);
    }

    public void persistProduct(Product product) {
        ctx.insertInto(BIL_PRODUCT, BIL_PRODUCT.PRODUCT_KEY, BIL_PRODUCT.PRODUCT_NAME_I18N)
                .values(product.getProductKey(), product.getProductNameI18n())
                .execute();
    }
}
